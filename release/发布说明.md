# pghttp v1.0.0 发布包说明

## ✅ 发布包已创建成功！

**发布日期**: 2025-11-14  
**版本**: 1.0.0  
**平台**: Windows x64 / Linux x64

---

## 📦 发布文件

### 1️⃣ Windows 预编译版（推荐 Windows 用户）

**文件**: `pghttp-1.0.0-win-x64.zip` (33.31 KB)

**包含内容**:
- ✅ 预编译 DLL (pghttp.dll)
- ✅ 自动安装脚本 (install.ps1)
- ✅ 完整文档（中文 + 英文）
- ✅ 示例代码

**使用方法**:
```powershell
# 1. 解压 ZIP 文件
# 2. 以管理员身份运行 PowerShell，进入解压目录
.\install.ps1

# 3. 在 PostgreSQL 中执行
CREATE EXTENSION pghttp;

# 4. 测试
SELECT http_get('https://httpbin.org/get');
```

**系统要求**:
- Windows 10/11 或 Windows Server 2016+
- PostgreSQL 12, 13, 14, 15, 16, 17, 18+ (64 位)
- 需要管理员权限

---

### 2️⃣ Linux 源码版（Linux 用户）

**文件**: `pghttp-1.0.0-linux-x64.zip` (31.86 KB)

**包含内容**:
- ✅ 跨平台源代码 (pghttp.c)
- ✅ Makefile 构建脚本
- ✅ 自动安装脚本 (install_linux.sh)
- ✅ 完整文档（中文 + 英文）
- ✅ 示例代码

**使用方法**:
```bash
# 1. 解压文件
unzip pghttp-1.0.0-linux-x64.zip
cd pghttp-1.0.0-linux-x64

# 2. 安装依赖（Ubuntu/Debian）
sudo apt-get update
sudo apt-get install postgresql-server-dev-all libcurl4-openssl-dev gcc make

# 3. 编译并安装
make clean && make
sudo make install

# 4. 在 PostgreSQL 中执行
CREATE EXTENSION pghttp;

# 5. 测试
SELECT http_get('https://httpbin.org/get');
```

**系统要求**:
- Linux 发行版: Ubuntu, Debian, CentOS, RHEL, Fedora, Arch
- PostgreSQL 12-18+ (需要 dev 包)
- GCC 或 Clang 编译器
- libcurl 开发库

---

## 🔒 安全校验

### Windows 包校验
```powershell
Get-FileHash pghttp-1.0.0-win-x64.zip -Algorithm SHA256
```
查看 `pghttp-1.0.0-win-x64-SHA256.txt` 获取正确的哈希值。

### Linux 包校验
```bash
sha256sum pghttp-1.0.0-linux-x64.zip
```
查看 `pghttp-1.0.0-linux-x64-SHA256.txt` 获取正确的哈希值。

---

## ✨ 功能特性

### 核心功能
- ✅ **HTTP GET 请求** - 获取数据
- ✅ **HTTP POST 请求** - 提交数据（自动添加 Content-Type）
- ✅ **所有 HTTP 方法** - PUT, DELETE, PATCH, HEAD, OPTIONS 等
- ✅ **详细响应** - 返回状态码、Content-Type、响应体
- ✅ **UTF-8 支持** - 完整的中文字符支持
- ✅ **超时保护** - 30 秒超时，防止阻塞
- ✅ **HTTPS 支持** - 完整的 SSL/TLS 加密

### 平台差异
| 特性 | Windows | Linux |
|------|---------|-------|
| HTTP 库 | WinHTTP (系统自带) | libcurl (需安装) |
| 外部依赖 | **零依赖** | libcurl |
| 分发形式 | 预编译 DLL | 源代码 |
| 安装难度 | ⭐ 简单 | ⭐⭐ 中等 |

### SQL API（跨平台完全一致）
```sql
-- 简单 GET
SELECT http_get('https://api.example.com/data');

-- POST JSON（自动添加 Content-Type: application/json）
SELECT http_post('https://api.example.com/users', '{"name":"张三","age":30}');

-- 详细响应（包含状态码、Content-Type、响应体）
SELECT * FROM http_request('GET', 'https://api.example.com/status');

-- 其他 HTTP 方法
SELECT * FROM http_request('PUT', 'https://api.example.com/update/123', '{"status":"已完成"}');
SELECT * FROM http_request('DELETE', 'https://api.example.com/item/123');
```

---

## 📚 文档说明

### 核心文档
1. **README.md** - 快速开始指南（本目录）
2. **RELEASE_NOTES_v1.0.0.md** - 完整发布说明（推荐阅读）
3. **DISTRIBUTION_GUIDE.md** - 分发指南

### Windows 包内文档
- `INSTALL_RELEASE.md` - Windows 安装详细步骤
- `USAGE.md` - 使用文档和最佳实践
- `examples.sql` - 20+ 实用示例
- `README_CN.md` - 中文说明
- `CROSSPLATFORM_README.md` - 跨平台使用说明

### Linux 包内文档
- `INSTALL_LINUX.md` - Linux 安装详细步骤
- `USAGE.md` - 使用文档和最佳实践
- `examples.sql` - 20+ 实用示例
- `README_CN.md` - 中文说明
- `CROSSPLATFORM_README.md` - 跨平台使用说明

---

## 🎯 典型应用场景

### 1. 调用第三方 API
```sql
-- 查询天气信息
SELECT http_get('https://api.weather.com/current?city=Beijing');

-- 发送短信通知
SELECT http_post('https://sms.api.com/send', 
    '{"phone":"13800138000","message":"订单已发货"}');
```

### 2. 微服务集成
```sql
-- 调用用户服务
SELECT body::jsonb->'user_id' 
FROM http_request('GET', 'https://user-service/api/users/123');

-- 更新库存
SELECT * FROM http_request('PUT', 
    'https://inventory-service/api/stock/456', 
    '{"quantity":100}');
```

### 3. Webhook 触发
```sql
-- 数据变更时触发 Webhook
CREATE TRIGGER notify_webhook
AFTER INSERT ON orders
FOR EACH ROW EXECUTE FUNCTION send_webhook();

CREATE FUNCTION send_webhook() RETURNS TRIGGER AS $$
BEGIN
    PERFORM http_post('https://webhook.site/xxx', 
        row_to_json(NEW)::text);
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

### 4. 数据同步
```sql
-- 定期同步外部数据
CREATE TABLE external_data AS
SELECT body::jsonb 
FROM http_request('GET', 'https://api.example.com/export');
```

---

## ❓ 常见问题

### Q1: Windows 版本支持哪些 PostgreSQL 版本？
**A**: 预编译包基于 PostgreSQL 15 编译，但兼容 12-18+ 版本。如果版本不匹配，可能需要重新编译。

### Q2: Linux 编译失败怎么办？
**A**: 
1. 确认已安装 `postgresql-server-dev-all` 和 `libcurl4-openssl-dev`
2. 检查 PostgreSQL 版本是否安装了开发包
3. 查看 `INSTALL_LINUX.md` 中的故障排除部分

### Q3: 如何处理 HTTPS 证书问题？
**A**: 
- Windows: WinHTTP 使用系统证书存储，自动处理
- Linux: libcurl 使用 `/etc/ssl/certs`，确保证书库是最新的

### Q4: 超时时间可以修改吗？
**A**: 当前硬编码为 30 秒。如需修改，需要重新编译（修改源码中的超时值）。

### Q5: 支持 HTTP 代理吗？
**A**: v1.0.0 版本暂不支持，计划在后续版本中添加。

### Q6: 如何调试 HTTP 请求？
**A**: 使用 `http_request()` 函数查看详细响应：
```sql
SELECT status_code, content_type, body 
FROM http_request('GET', 'https://httpbin.org/status/404');
```

---

## 🔄 版本兼容性

### PostgreSQL 版本
| 版本 | Windows | Linux | 说明 |
|------|---------|-------|------|
| 12.x | ✅ | ✅ | 需要重新编译 |
| 13.x | ✅ | ✅ | 需要重新编译 |
| 14.x | ✅ | ✅ | 需要重新编译 |
| 15.x | ✅ | ✅ | **推荐**（预编译基于此版本） |
| 16.x | ✅ | ✅ | 需要重新编译 |
| 17.x | ✅ | ✅ | 需要重新编译 |
| 18.x | ✅ | ✅ | 需要重新编译 |

### 操作系统
| 系统 | 版本 | 状态 |
|------|------|------|
| Windows 10 | 1809+ | ✅ 完全支持 |
| Windows 11 | All | ✅ 完全支持 |
| Windows Server | 2016+ | ✅ 完全支持 |
| Ubuntu | 18.04+ | ✅ 完全支持 |
| Debian | 10+ | ✅ 完全支持 |
| CentOS | 7/8 | ✅ 完全支持 |
| RHEL | 7/8/9 | ✅ 完全支持 |
| Fedora | 35+ | ✅ 完全支持 |
| macOS | 任意版本 | 🔶 理论支持（未测试） |

---

## 📞 获取帮助

1. **查看文档**: 先阅读包内的 INSTALL 和 USAGE 文档
2. **查看示例**: `examples.sql` 包含 20+ 实际示例
3. **发布说明**: `RELEASE_NOTES_v1.0.0.md` 包含所有技术细节

---

## 📊 发布统计

- **总文件数**: 7
- **总大小**: 约 84 KB
- **支持平台**: 2 (Windows, Linux)
- **支持 PostgreSQL 版本**: 7 个主要版本
- **文档页数**: 100+ 页

---

## 🎉 开始使用

### Windows 用户
1. 下载 `pghttp-1.0.0-win-x64.zip`
2. 解压后运行 `install.ps1`（管理员权限）
3. 在 PostgreSQL 中 `CREATE EXTENSION pghttp;`
4. 开始使用！

### Linux 用户
1. 下载 `pghttp-1.0.0-linux-x64.zip`
2. 解压并安装依赖
3. 运行 `make && sudo make install`
4. 在 PostgreSQL 中 `CREATE EXTENSION pghttp;`
5. 开始使用！

---

**祝使用愉快！** 🚀

如有问题，请查阅发布包内的详细文档。

---

*pghttp - 让 PostgreSQL 轻松调用 HTTP API*  
*版本: 1.0.0 | 日期: 2025-11-14 | 许可: MIT*
